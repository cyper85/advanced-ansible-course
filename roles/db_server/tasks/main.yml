---
# tasks file for db_server
-
  name: install mysql database
  yum:
    name: ['mariadb-server', 'python3-mysqlclient']
    state: installed
  become: yes
-
  name: start mysql server
  service:
    name: mariadb
    state: started
    enabled: yes
  become: yes
-
  name: Create Application database
  mysql_db:
    name: "{{ db_name }}"
  become: yes
-
  name: Create MySQL-User
  mysql_user:
    name: "{{ db_user }}"
    password: "{{ db_password }}"
    priv: '*.*:ALL'
    state: present
    host: '%'
  become: yes
-
  name: enable mysql-port in firewall
  firewalld:
    port: "{{ mysql_port | default(3306) }}/tcp"
    permanent: yes
    state: enabled
  become: yes
